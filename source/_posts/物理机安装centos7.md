---
title: 物理机安装centos7
date: 2021-09-07 19:46:00
categories: 
tags: []
copyright: true #新增,开启
---

这几天捡了一波垃圾，凑出来台主机。今天就来讲下整套装机流程（硬件+软件）
<!--more-->
## 硬件
#### 硬件介绍
必备硬件
主板：
- CPU：
- 内存：
- 硬盘：没有硬盘也可以用U盘引导进PE系统
- 电源：任何质量电源都能开机，不过电源是整个机器比较关键的部分。电源一boom，能活下来的配件没几个

可选硬件：
- 散热器：现在台式除了苹果M1，其他目前还没见过不需要散热器的CPU。没散热器也可以开机，不过很快就会触发过热保护
- 显卡：独立显卡，主板集成显卡，CPU集成显卡。种类很多，没有显卡就无法输出画面，只能远程ssh
- 网卡：大部分家用主板会集成网卡，有些主板无网卡，只能自己买独立网卡
- 机箱：一般机箱会有电源跳线，分正负极。没有机箱也可以通过拿螺丝刀轻轻碰一下，短接电源跳线来开机
- 
#### 装机流程
1、安装CPU：新款CPU一般阵脚都在主板上，老款的话，阵脚在CPU上。

2、安装内存条：推荐先安装内存条，有的散热器会卡住内存位，顺序乱了塞不进去

3、涂硅脂：推荐x涂发，总计1粒大米大小就可以

4、安装散热器：散热器放上轻轻旋转两下，感觉上抹匀硅脂即可。有的散热器特别重，此时主板不建议竖放，或者能有支撑也行

5、散热器接线：散热器拉出来线接到主板

6、CPU接线：电源拉出来线接到CPU（注意别把PCIE和CPU的线弄错了，电压不同会boom）

7、主板电源接线：电源上主板线拉出来插到主板

8、接开关机等跳线：这个可以去查自己主板的跳线图，避免接错

9、塞入机箱和电源：根据机箱形状自己看着弄，先塞机箱也无所谓

10、安装硬盘：台式机硬盘是独立供电，从电源拉出来sata电源线接上，再找根sata数据线把硬盘主板连起来。先后顺序自己看着办，有的硬盘没托盘需要自己螺丝拧到机箱上，比较麻烦

## 软件
#### U盘启动盘制作
这次做的是Centos7.9系统。从网络下载镜像后，使用过rufus和软碟通制作U盘启动盘（首先你要有U盘）

根据实际体验，发现rufus制作的MBR和GPT两种模式，均出现安装成功后，无限重启的情况，未找到解决方式。  
软碟通制作的，有2个BUG。
- 系统无法识别特殊字符，例如空格
- 制作后U盘名字和引导程序中不一致
  
解决方式，制作好后，将U盘改名123等简单名字。随后将EFI->BOOT->GRUFE.cfg中引用到的，类似Centos 7 x86_64的名字全部改成U盘名，就可以正常使用。

#### U盘启动盘启动
这里提醒一点，如果U盘启动时选择legacy启动的，制作出来系统也只能legacy模式启动。反之，uefi也是如此。  
UEFI为较新启动方式，如果有,建议使用。旧平台很多不支持UEFI，那就随意  

有时bios->boot里面首选启动项看不到自己U盘，或者某个模式找不到自己U盘。  
可以选择进入启动菜单（临时弹出来一个框，让你选择用哪个硬盘启动），每个品牌快捷键不一样

#### 有线网卡驱动安装
网上很多教程都是在搞笑。例如，先修改yum源，再yum install xxx

网卡驱动都没安装，怎么可能上的去网？

这里介绍下，即使选择最小化安装centos，也是有网卡驱动的。前提是你的网卡在它的兼容范围内。  
如果自己的网卡不被兼容，只能去网卡官网找驱动。通过U盘拷贝给centos，centos通过make等命令自己编译和安装

这种方式较为困难，编译时会遇到很多包不存在，可以去U盘里面Package包找对应的，用rpm命令安装依赖包。  
如果gcc缺实，只能通过u盘把gcc也拷过去。

如果网卡驱动可以兼容(基本都是先试试)，则执行ip addr看看自己网卡是哪个（数量太多认不出来就靠蒙）。  
然后去/etc/sysconfig/network-scripts/下面找对应网卡名的文件。  
用vi命令（注意是vi，新机器没vim）修改，文件中对应内容改成onboot=yes。  
修改后service network restart重启网络。  
这些操作弄完，插根网线就能上网了

#### yum安装软件
新系统时钟一般是错误的，这时候yum install会告诉你协议过期。  
用date命令把日期改成今天就好了。

如果连不上官方的yum源，就去找个国内的源设置上来用，源的链接可能会变，注意找时间新的多尝试下

#### 如何知道散热器有没有安装好
lm_sensors工具可以看cpu温度。  
找个CPU压力工具，各个档次的负载调一调，看看cpu温度变化是否异常就行。异常的判断标准，可以参考下自己CPU的功耗，以及其他人烤机的图。  
不同款CPU可能温度差别极大

#### root用户安装的软件其他用户怎么用
一般安装软件，软件都会自己搞个用户组出来。linux一个用户可以同时属于多个用户组，把其他用户添加到该软件对应的用户组，然后重新登陆就可以了，

